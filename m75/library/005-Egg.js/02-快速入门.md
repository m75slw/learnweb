[TOC]
## 初始化

### 生成项目
```cmd
mkdir egg-example && cd egg-example  新建文件夹并进入
npm init egg --type=simple  初始化 type可选
npm i  安装项目依赖                     
```
### 启动项目
```cmd
npm run dev
open http://localhost:7001
  
或者在浏览器打开
```

### 目录结构
```
egg-example
|---package.json
|---app.js(可选)
|---agent.js(可选)
|
|---app
|    |---controller    用于解析用户的输入、处理后返回响应的结果
|    |       |---home.js
|    |       |---其他自建的文件夹/文件
|    |
|    |---public(可选)    放置静态资源文件
|    |      |---静态资源文件
|    |
|    |---view    放置模板文件V
|    |    |---home.ejs
|    |    |---视图文件
|    |
|    |---router.js    用于配置url路由规则C
|    |
|    |---service(可选)    用于编写业务逻辑层M
|    |      |---user.js
|    |
|    |---middleware(可选)    用于编写中间件
|    |        |---response_time.js
|    |        
|    |---schedule(可选)    用于定时任务
|    |        |---my_task.js
|    |
|    |---extend(可选)    框架的扩展
|           |---helper.js(可选)
|           |---request.js(可选)
|           |---response.js(可选)
|           |---application.js(可选)
|           |---agent.js(可选)
|           
|---config
|      |---config.default.js    用于编写配置文件
|      |---plugin.js    配置需要加载的插件
|      |
|      |---config.prod.js
|      |---config.test.js(可选)
|      |---config.local.js(可选)
|      |---config.unittest.js(可选)
|
|---test    用于单元测试
|    |---midddleware
|    |        |---repons_time.test.js
|    |
|    |---controller
|    |       |---home.test.js


```



## 项目搭建

### 编写Controller和Router
```js
// app/controller/home.js
'use strict';

const Controller = require('egg').Controller;

class HomeController extends Controller {
  async index() {
    const { ctx } = this;
    ctx.body = 'hi, egg';
  }
}

module.exports = HomeController;
```
配置路由映射
```js
module.exports = app => {
  const { router, controller } = app;
  router.get('/', controller.home.index);
  //管理端路由
  router.get('/api/adminlogin',controller.admin.login.login);
};
```
### 静态资源
```js
  //app/public
这个目录下存放html、css、img等静态资源
```
模板
>npm i egg-view-ejs --save  
开启插件，然后配置Controller和Router
```js
// config/plugin.js
exports.ejs = {
  enable: true,
  package: 'egg-view-ejs'
};
等价↓:
module.exports = {
  ejs:{
    enable: true,
    package: 'egg-view-ejs'
  }
};
```

```js
// config/config.default.js
exports.keys = <此处改为你自己的 Cookie 安全字符串>;
// 添加 view 配置
exports.view = {
  defaultViewEngine: 'ejs',
  mapping: {
    '.tpl': 'ejs',
  },
};
等价↓
module.exports = appInfo => {
  
  const config = exports = {};
  config.keys = appInfo.name + '_1634115019286_2172';
  config.middleware = [];
  const userConfig = {
  };
  config.view = {
    defaultViewEngine: 'ejs',
    mapping: {
      '.html': 'ejs',
    },
  };
  return {
    ...config,
    ...userConfig,
  };

```
### mysql的使用
插件安装
```cmd
npm i --save egg-mysql
```
开启插件
```js
// config/plugin.js
exports.mysql = {
  enable: true,
  package: 'egg-mysql',
};
```

```js
//config/config.default.js
不同数据源不同配置
```


### 编写service,并在router中使用
```js
//app/service/Goods.js
'use strict';
const Service =require('egg').Service;
class GoodsService extends Service{
    async index(){
        let goods=await this.app.mysql.select('nav',{
            columns:['title'],
        });
        return goods;
    }
}
module.exports=GoodsService;
```

```js
//app/controller/test.js
'use strict';
const Controller = require('egg').Controller;
class GoodsController extends Controller {
    async index() {
        let {ctx}=this;
        let result=await ctx.service.goods.index();
        // console.log(result);
        // await ctx.render('html/Goods.html');
        ctx.body=result;
    }
  }
module.exports = GoodsController;
```

### 编写拓展

#### Application

#### Context
#### Request
#### Response
#### Helper  

**方法拓展**  

**属性拓展**  

### 编写中间件

